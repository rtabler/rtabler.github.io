<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Lifeline</title>
  <!-- <meta name="description" content="The HTML5 Herald"> -->
  <!-- <meta name="author" content="SitePoint"> -->

  <!-- <link rel="stylesheet" href="style.css"> -->
  <!-- <link rel="stylesheet" href="css/styles.css?v=1.0"> -->

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>

<body>
  <h1>Hi</h1>
  <form onsubmit="return submitForm(event)">
    <h2>Message:</h2>
    <input name="inputtext" type="text">
    <input name="submitbutton" type="submit">
  </form>
  <script src="jquery-3.3.1.js"></script>
  <script>

var onResponse = function() {
  if (this.readyState == 4) {
    console.log(JSON.stringify(this));
    console.log(this.status);
    console.log(this.responseText);
  }
}
var submitForm = function( event ) {
  var xhr = new XMLHttpRequest();

  var messageText = "";
  var inputTextElements = document.getElementsByName("inputtext");
  for (var i=0; i<inputTextElements.length; i++) {
    messageText += inputTextElements[i].value;
  }
  console.log(messageText);

  // xhr.onreadystatechange = onResponse;
  // xhr.open("POST", "https://us-central1-lifeline-d8ce8.cloudfunctions.net/addMessage?text="+messageText, true);
  // xhr.send();

  $.ajax({
    method: "POST",
    url: "https://us-central1-lifeline-d8ce8.cloudfunctions.net/addMessage?text="+messageText,
    // data: {
    //   text: messageText
    // }
  }).done(function( msg ) { 
    alert("returned done");
    console.log( msg );
  }).fail(function( msg ) {
    alert("returned fail")
    console.log( msg );
  });

  event.preventDefault();
  return false;
}
// alert("Hello");
  </script>
</body>
</html>